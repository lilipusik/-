# Генератор поздравлений
Лабораторная работа по дисциплине "Современные языки и технологии программирования"
Кравчук Юлия (ПГНИУ, Мехмат, 2 курс, ПМИ-5-21)

# Задание
Лабораторная работа направлена на изучение взаимодействия C#, MS Word и MS Excel.

- Входные данные
На вход программе поступают группы пожеланий, фразы-пожелания, список имен людей, для которых будут генерироваться поздравления, а также другие настроечные данные. Эти данные размещаются в файлах в формате xls или xlsx. Фразы-пожелания разбиты на тематические группы, например, «счастье», «учеба», «семья» и т.д. Также на вход подаются шаблоны открыток (можно один шаблон) с установленными закладками для вывода поздравлений. Эти шаблоны размещаются в файлах в формате doc или docx. Если шаблонов несколько, то они помещаются в отдельную директорию рядом с генератором поздравлений. 

- Выходные данные
Для каждого запуска генератор поздравлений выдает один файл в формате doc или docx со сгенерированными открытками-поздравлениями для всех людей из входного списка. Каждая открытка-поздравление содержит сгенерированные поздравительные триады (при этом все поздравления в одном файле должны быть уникальны).

- Уточнение
Допускается вместо MS Word / MS Excel использовать другие текстовый и табличный редакторы, в том числе входящие в свободно распространяемые пакеты прикладных программ, при условии наличия в этих редакторах аналогичных возможностей (например, редакторы Writer и Calc из пакета LibreOffice).

- Основные требования
1.	Вручную создать шаблон открытки.
  1.1.	Добавить на страницу праздничную картинку.
  1.2.	На картинку наложить одну таблицу для удобного позиционирования текста. В ячейки таблицы добавить именованные закладки для вывода в них соответствующих частей текста открытки. Допускается для позиционирования текста использовать настройки абзацев и табуляций.
  1.3.	Размер страницы шаблона и выходного файла должен совпадать с размером праздничной картинки.
2.	Вручную подготовить входной файл. Файл в формате электронной таблицы должен содержать минимум 3 листа: для списка имен, для списка групп и пожеланий, для настроек. Фразы-пожелания и группы пожеланий должны быть легко пополняемыми, настроечные данные легко изменяться. Каждый лист входного файла должен иметь соответствующее название.
3.	Написать программу на языке C#.
  3.1.	Подготовить необходимые типы данных (модель данных) для хранения имен людей, фраз-пожеланий, сгенерированных триад пожеланий. Разделить код программы на «интерфейс» и «бизнес-логику». Сначала нужно считать все данные, потом сгенерировать все поздравления, затем выгрузить всю информацию в выходные файлы.
  3.2.	Организовать чтение данных из входных файлов в соответствующие структуры данных. 
  3.3.	Текстом для открытки является обращение к человеку из списка имен, поздравление с праздником (фиксированный текст) и триада, составленная из фраз-пожеланий. Праздник можно выбрать по вашему желанию. Пример: «Дорогая, Эмилия! Поздравляю тебя с Новым Годом! Желаю теплых улыбок, исполнения желаний, отличного настроения!»
  3.4.	Для построения триады случайным образом выбираются три тематические группы пожеланий, из которых случайным образом выбираются по одной фразе-пожеланию.
  3.5.	Выходной файл создается путем копирования подготовленного шаблона открытки. Это необходимо для сохранения в выходном файле параметров страницы, заданных в шаблоне. Обратите внимание, что шаблон открытки после запуска программы не должен измениться, поскольку шаблон открытки и выходной файл – разные файлы.
  3.6.	Текст открытки для первого человека вставляется сразу в выходной файл. Для каждого следующего человека необходимо добавить шаблон открытки в конец выходного файла и в добавленную часть вставить текст открытки в соответствующие закладки. 
  3.7.	После завершения генерации поздравлений необходимо выдать сообщение об окончании генерации.
  	
- Дополнительные требования
1.	Для всех имен из списка людей должны быть сгенерированы разные триады. Триады считаются одинаковыми, если содержат одинаковый набор фраз-пожеланий (даже если эти фразы располагаются в разном порядке). Фразы-пожелания в разных триадах могут повторно использоваться.
2.	При генерации триад нужно максимально охватить все фразы-пожелания из тематической группы. Т.е. при случайном выборе группы пожеланий предпочтение отдается фразе, которая еще не выбиралась из этой группы для других триад. Если неиспользованные фразы в некоторой группе пожеланий закончились, то их можно повторно использовать.
3.	Перед генерацией поздравлений оценить возможность генерации уникальных триад для заданного количества имен. В случае невозможности генерации уникальных поздравлений, выдать сообщение о необходимости пополнить список фраз-пожеланий или добавить новые группы пожеланий.
4.	Для вывода текста открытки необходимо использовать шрифты, отличные от Times New Roman, Courier New, Arial или Calibri.
5.	Шрифт вывода текста открытки необходимо хранить в настроечных данных.
6.	Путь до шаблона открытки должен храниться в настроечных данных.
7.	Выходные файлы, полученные при предыдущих запусках генератора поздравлений, не должны удаляться. Каждый новый выходной файл должен иметь уникальное имя.
8.	Рядом с генератором поздравлений необходимо создать папку, куда будут сохраняться все выходные файлы для каждого запуска генератора поздравлений. При создании выходного файла генератор поздравлений должен выполнить проверку наличия такой папки и – в случае ее отсутствия – программно создать.

# Файлы
1. Генератор поздравлений.xlsx - файл с исходными данными
2. Шаблон открытки.docx - шаблон открытки
3. NewFile №{i}.doc - итоговые открытки с поздравлениями

# О программе
1. ReadExcelFile.cs: открытие файла Excel и чтение из него данных для дальнейшей работы с исходными данными
2. Generator.cs: создание поздравлений для каждого человека
3. CreateWordFile.cs: создание итогового файла Word с созданными поздравлениями
